---
title: LWE-Based QFE
author: Shiyu
date: 2025-08-05 00:00:00 -0400
tags:
  - FE
pin: false
math: true
render_with_liquid: false
---
Today we will look at a construction of (bounded-collusion) quadratic functional encryption (QFE), which is proposed by Agrawal and Rosen in [AR17]. This construction is based on LWE/Ring LWE and uses a linear FE. The ciphertext size of this QFE construction depends on that of LFE. Specifically, let $w$ denote the number of variables of quadratic functions, $Q$ denote the number of collusions, the QFE ciphertext is an encryption of $(w + Q + 1)$-dimensional vector using LFE.

The starting point of this QFE construction is a Ring-LWE-based somewhat homomorphic encryption (HE) proposed by Brakerski and Vaikuntanathan in [BV11], where the ciphertext is of the form $c = u\cdot s + 2\mu + x$ for a plaintext $x$. $u$ is a randomness, $s$ is the symmetric key, and $\mu$ is an error. For two plaintexts $x_i, x_j$, their product can be written as $x_ix_j \approx (u_i u_j)s^2 - (u_i c_j + u_j c_i)s + c_i c_j$. It can be viewed as a polynomial in $s$, and can be computed using $s$ as an inner-product $\langle (u_i u_j, -(u_ic_j + u_j c_i), c_i c_j), (s^2, s^1, s^0)\rangle$.

To construct QFE, for a quadratic polynomial $f(x) = \sum_{1\leq i\leq j\leq w} g_{ij} x_i x_j$ and a message $x = (x_1, ..., x_w)$, it is insecure to directly give out the secret $s$ as the functional decryption key. Thus, the decryption in the proposed QFE is computed as $\langle (s^2, c_j s, c_i s), (u_i u_j, u_i, u_j) \rangle$, where the first vector containing $s$ serves as the message vector, and the second one without $s$ is the key vector. But this solution is still insecure. Because the decryptor can get the term $u_i u_j (s^2) - u_i (c_j s) - u_j (c_i s)$, which is an exact quadratic equations in the secret $s$.
The solution is to add noise artificially when encrypting the message vector, which increases the ciphertext size.

**Reference**
- [AR17]  [Functional Encryption for Bounded Collusions, Revisited](https://eprint.iacr.org/2016/361.pdf). Shweta Agrawal and Alon Rosen.
- [BV11] [Fully Homomorphic Encryption from Ring-LWE and Security for Key Dependent Messages](https://www.cs.toronto.edu/~vinodv/BV-Crypto2011.pdf). Zvika Brakerski and Vinod Vaikuntanathan.